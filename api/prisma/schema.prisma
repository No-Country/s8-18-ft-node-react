datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URI_DEV")
}

generator client {
  provider = "prisma-client-js"
}

model Users {
  id                String              @id @default(uuid()) @db.VarChar(36)
  first_name        String
  last_name         String
  email             String              @unique
  password          String
  phone_number      Int
  createdAt         DateTime            @default(now())
  updateAt          DateTime            @updatedAt
  organizationRoles OrganizationRoles[]
  Organizations     Organizations[]
}

model Organizations {
  id                String              @id @default(uuid()) @db.VarChar(36)
  createdAt         DateTime            @default(now())
  updateAt          DateTime            @updatedAt
  owner             Users               @relation(fields: [owner_id], references: [id], onDelete: Cascade)
  owner_id          String
  organizationRoles OrganizationRoles[]
  Inventories       Inventories[]
  Products          Products[]
}

enum Role {
  SUPERADMIN
  ADMIN
  VENDEDOR
}

model OrganizationRoles {
  id              String        @id @default(uuid()) @db.VarChar(36)
  createdAt       DateTime      @default(now())
  updateAt        DateTime      @updatedAt
  organization    Organizations @relation(fields: [organization_id], references: [id], onDelete: Cascade)
  organization_id String
  role            Role
  user            Users         @relation(fields: [user_id], references: [id], onDelete: Cascade)
  user_id         String
  Inventories     Inventories[]

  @@unique([user_id, organization_id], name: "oneRolePerOrganization")
}

model Inventories {
  id              String              @id @default(uuid()) @db.VarChar(36)
  createdAt       DateTime            @default(now())
  updateAt        DateTime            @updatedAt
  organization    Organizations       @relation(fields: [organization_id], references: [id], onDelete: Cascade)
  organization_id String
  name            String              @db.VarChar(400)
  admins          OrganizationRoles[]
}

model Stocks {
  id         String    @id @default(uuid()) @db.VarChar(36)
  createdAt  DateTime  @default(now())
  updateAt   DateTime  @updatedAt
  product    Products  @relation(fields: [product_id], references: [id], onDelete: Cascade)
  product_id String
  condition  Condition
  quantity   Int

  @@unique([product_id, condition], name: "oneProductCondition")
}

enum Condition {
  USADO
  NUEVO
}

model Products {
  id              String        @id @default(uuid()) @db.VarChar(36)
  createdAt       DateTime      @default(now())
  updateAt        DateTime      @updatedAt
  name            String        @db.VarChar(255)
  description     String        @db.VarChar(400)
  barcode         String        @db.VarChar(255)
  brand           String        @db.VarChar(255)
  Stocks          Stocks[]
  organization    Organizations @relation(fields: [organization_id], references: [id], onDelete: Cascade)
  organization_id String
}
