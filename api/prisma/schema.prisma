datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URI_DEV")
}

generator client {
  provider = "prisma-client-js"
}

model Users {
  id                String              @id @default(uuid()) @db.VarChar(36)
  first_name        String
  last_name         String
  email             String              @unique
  password          String
  phone_number      Int
  createdAt         DateTime            @default(now())
  updateAt          DateTime            @updatedAt
  organizationRoles OrganizationRoles[]
  Organizations     Organizations[]
}

model Organizations {
  id                String              @id @default(uuid()) @db.VarChar(36)
  createdAt         DateTime            @default(now())
  updateAt          DateTime            @updatedAt
  owner             Users               @relation(fields: [owner_id], references: [id], onDelete: Cascade)
  owner_id          String
  organizationRoles OrganizationRoles[]
}

enum Role {
  SUPERADMIN
  ADMIN
  VENDEDOR
}

model OrganizationRoles {
  id              String        @id @default(uuid()) @db.VarChar(36)
  organization    Organizations @relation(fields: [organization_id], references: [id], onDelete: Cascade)
  organization_id String
  role            Role
  user            Users         @relation(fields: [user_id], references: [id])
  user_id         String

  @@unique([user_id, organization_id], name: "oneRolePerOrganization")
}
